# 浏览器存储方式

<!-- TOC -->

- [浏览器存储方式](#浏览器存储方式)
  - [IndexDB](#indexdb)
  - [Cookie](#cookie)
  - [session](#session)
    - [session和cookie的区别](#session和cookie的区别)
  - [LocalStorage](#localstorage)
  - [sessionStorage](#sessionstorage)
    - [cookies，sessionStorage 和 localStorage 的区别](#cookiessessionstorage-和-localstorage-的区别)
      - [用法不同](#用法不同)
      - [存储大小](#存储大小)
      - [有期时间](#有期时间)
      - [作用域不同](#作用域不同)

<!-- /TOC -->

## IndexDB

是 HTML5 的本地存储，把一些数据存储到浏览器（客户端）中，当与网络断开时，可以从浏览器中读取数据，用来做一些离线应用

## Cookie

通过在浏览器的内存或磁盘上保存字符串信息，记录确定用户身份，最大为 4 kb

> 在跨域请求是不会携带cookie，如果需要携带，则设置 xhr.withCredentials: true

```js
function SetCookie(name, value) {
    document.cookie = name + "=" + encodeURI(value) + ";expires=" + exp.toGMTString() + ";
}

function GetCookie(name) {
    let reg = ...
    arr = document.cookie.match(reg))
    nameValue = decodeURI(arr[2]);
    return nameValue;
```

## session

是服务器端使用的一种记录客户端状态的机制，通常借助cookie来确定会话标识

### session和cookie的区别

1. session 在服务器端，cookie 在客户端（浏览器）
1. cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗,考虑到安全应当使用session
1. session访问量大时，会占用内存，影响性能
1. 用户验证这种场合一般会用 session。因此，维持一个会话的核心就是客户端的唯一标识，即 session id

## LocalStorage

是 HTML5 的本地存储，将数据保存在客户端中（一般是永久的)

- 添加键值对：localStorage.setItem(key,value)
- 获取键值：localStorage.getItem(key)
- 删除键值对：localStorage.removeItem(key)。
- 清除所有键值对：localStorage.clear()。
- 获取localStorage的属性名称（键名称）：localStorage.key(index)。


## sessionStorage

它与 localStorage 相似，不同之处在于 localStorage 里面存储的数据没有过期时间设置，而存储在 sessionStorage 里面的数据在页面会话结束时会被清除

```js
// 保存数据到sessionStorage
sessionStorage.setItem('key', 'value');

// 从sessionStorage获取数据
var data = sessionStorage.getItem('key');

// 从sessionStorage删除保存的数据
sessionStorage.removeItem('key');

// 从sessionStorage删除所有保存的数据
sessionStorage.clear();
```

### cookies，sessionStorage 和 localStorage 的区别

#### 用法不同

- cookie:
  - cookie是网站为了标示用户身份而储存在用户本地终端（Client Side）上的数据（通常经过加密）。
  - cookie数据始终在同源的http请求中携带（即使不需要），记会在浏览器和服务器间来回传递。
- sessionStorage和localStorage不会自动把数据发给服务器，仅在本地保存

#### 存储大小

- cookie数据大小不能超过4k。
- sessionStorage和localStorage 虽然也有存储大小的限制，但比cookie大得多，可以达到5M或更大

#### 有期时间

- localStorage    存储持久数据，浏览器关闭后数据不丢失除非主动删除数据；
- sessionStorage  数据在当前浏览器窗口关闭后自动删除。
- cookie          设置的cookie过期时间之前一直有效，即使窗口或浏览器关闭

#### 作用域不同

sessionStorage不在不同的浏览器窗口中共享，即使是同一个页面；
localStorage 在所有同源窗口中都是共享的；cookie也是在所有同源窗口中都是共享的。