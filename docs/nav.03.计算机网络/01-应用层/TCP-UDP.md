# TCP / UDP

## TCP

TCP（Transmission Control Protocol，传输控制协议）是基于连接的协议，也就是说，在正式收发数据前，必须和对方建立可靠的连接。

一个TCP连接必须要经过三次“对话”才能建立起来

### 名词解释

1. ACK 是 TCP 报头的控制位之一，对数据进行确认。确认由目的端发出，用它来告诉发送端这个序列号之前的数据段都收到了
   1. 比如确认号为X，则表示前 X-1 个数据段都收到了，只有当 ACK=1 时,确认号才有效，当 ACK=0 时，确认号无效，这时会要求重传数据，保证数据的完整性
2. SYN 同步序列号，TCP建立连接时将这个位 置1
3. FIN 发送端完成发送任务位，当TCP完成数据传输需要断开时,提出断开连接的一方将这位置1

### 特性

#### 三次握手

需要进行三次握手：

1. 第一次握手：主机A通过向主机B 发送一个含有同步序列号的标志位的数据段给主机B，向主机B 请求建立连接，通过这个数据段，主机A告诉主机B 两件事：我想要和你通信；你可以用哪个序列号作为起始数据段来回应我
2. 第二次握手：主机B 收到主机A的请求后，用一个带有确认应答（ACK）和同步序列号（SYN）标志位的数据段响应主机A，也告诉主机A两件事：我已经收到你的请求了，你可以传输数据了；你要用那个序列号作为起始数据段来回应我
3. 第三次握手：主机A收到这个数据段后，再发送一个确认应答，确认已收到主机B 的数据段："我已收到回复，我现在要开始传输实际数据了，这样3次握手就完成了，主机A和主机B 就可以传输数据了

#### 四次挥手

1. 第一次：当主机A完成数据传输后,将控制位 FIN 置1，提出停止 TCP 连接的请求
2. 第二次：主机B收到FIN后对其作出响应，确认这一方向上的TCP连接将关闭,将 ACK 置1
3. 第三次：由B端再提出反方向的关闭请求,将 FIN 置1
4. 第四次：主机A对主机B的请求进行确认，将 ACK 置1，双方向的关闭结束

### TCP应用

- HTTP
- SMTP 电子邮件
- TELENT 远程终端接入
- FTP

## UDP

UDP（User Data Protocol，用户数据报协议）是与TCP相对应的协议。它是面向 **非连接** 的协议，它不与对方建立连接，而是直接就把数据包发送过去

UDP适用于一次只传送少量数据、对可靠性要求不高的应用环境

### UDP应用

- DNS
- TFTP
- RIP 路由选择协议
- DHCP / BOOTP
- SNMP 网络管理
- NFS 远程文件服务器

## 异同点

1. 基于连接与无连接
2. 对系统资源的要求（TCP 较多，UDP 少）
3. UDP程序结构较简单
4. 流模式与数据报模式
5. TCP保证数据正确性，UDP可能丢包
6. TCP保证数据顺序，UDP不保证
